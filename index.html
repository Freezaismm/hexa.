<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nadine's Hexa Perfect</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a10;
            --hex-bg: rgba(255, 255, 255, 0.05);
            --accent: #00f3ff;
            --gold: #ffd700;
        }

        * { box-sizing: border-box; user-select: none; touch-action: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; background-color: var(--bg-dark); color: white;
            font-family: 'Orbitron', sans-serif; overflow: hidden; height: 100vh;
            display: flex; justify-content: center; align-items: center;
            background-image: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #000 100%);
        }

        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0) 50%, rgba(0,0,0,0.15) 50%);
            background-size: 100% 3px; pointer-events: none; z-index: 999;
        }

        .screen {
            position: absolute; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.5s; z-index: 10;
        }
        .screen.active { opacity: 1; pointer-events: all; z-index: 100; }

        /* --- FOTO & UI --- */
        .photo-frame {
            width: 130px; height: 130px;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            background: var(--accent); padding: 3px;
            animation: float 3s ease-in-out infinite;
        }
        .photo-inner {
            width: 100%; height: 100%; background: #000;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        .photo-inner img { width: 100%; height: 100%; object-fit: cover; }
        @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }

        .btn {
            background: rgba(0, 243, 255, 0.15); border: 1px solid var(--accent);
            color: var(--accent); padding: 12px 25px; margin-top: 15px;
            font-family: inherit; font-size: 1rem; cursor: pointer; letter-spacing: 2px;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
        }

        /* --- GAME HEADER --- */
        .hud { position: absolute; top: 15px; width: 100%; text-align: center; z-index: 200; }
        .score-bar {
            width: 200px; height: 10px; background: #333; margin: 5px auto;
            border-radius: 5px; overflow: hidden; border: 1px solid #555;
        }
        .score-fill { width: 0%; height: 100%; background: linear-gradient(90deg, #f0f, #0ff); transition: width 0.3s; }

        .btn-shuffle {
            position: absolute; bottom: 20px; right: 20px;
            background: rgba(255,215,0,0.1); border: 1px solid var(--gold); color: var(--gold);
            padding: 8px 15px; font-size: 0.8rem; border-radius: 20px; cursor: pointer;
        }

        /* --- HEX GRID --- */
        #hex-grid {
            margin-top: 20px; display: flex; flex-direction: column; align-items: center; gap: 8px;
            transform: scale(0.95);
        }
        .hex-row { display: flex; gap: 8px; }
        .hex-row:nth-child(even) { transform: translateX(34px); }

        .hex-cell {
            width: 68px; height: 78px; position: relative;
            background: var(--hex-bg);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            cursor: pointer; transition: 0.2s;
        }
        
        .hex-cell.selected { background: rgba(255,255,255,0.1); transform: scale(1.1); z-index: 50; }
        .hex-cell.selected::after {
            content:''; position:absolute; inset:0; 
            box-shadow: inset 0 0 15px var(--accent); z-index:0;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }

        /* --- TILES (TUMPUKAN) --- */
        .tile {
            position: absolute; width: 54px; height: 62px;
            left: 50%; top: 50%; transform: translate(-50%, -50%);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            z-index: 10; transition: top 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: inset 0 -3px 0 rgba(0,0,0,0.3); /* Ketebalan */
        }
        /* Style warna neon */
        .t-c1 { background: #ff0055; box-shadow: 0 4px 0 #990033; }
        .t-c2 { background: #00ccff; box-shadow: 0 4px 0 #006699; }
        .t-c3 { background: #cc00ff; box-shadow: 0 4px 0 #660099; }
        .t-c4 { background: #00ff66; box-shadow: 0 4px 0 #009933; }
        .t-c5 { background: #ffcc00; box-shadow: 0 4px 0 #cc8800; }

        /* Efek Tumpukan Tinggi */
        .tile:nth-child(1) { margin-top: 0px; z-index: 5; }
        .tile:nth-child(2) { margin-top: -6px; z-index: 6; }
        .tile:nth-child(3) { margin-top: -12px; z-index: 7; }
        .tile:nth-child(4) { margin-top: -18px; z-index: 8; }
        .tile:nth-child(5) { margin-top: -24px; z-index: 9; }
        .tile:nth-child(6) { margin-top: -30px; z-index: 10; }

        /* --- END TEXT --- */
        .text-area {
            width: 85%; max-height: 250px; background: rgba(0,0,0,0.85);
            border: 1px solid var(--gold); padding: 15px; border-radius: 8px;
            font-family: 'VT323', monospace; font-size: 1.1rem; color: #ffebcd;
            overflow-y: auto; margin-top: 10px;
        }
    </style>
</head>
<body>

    <div class="scanlines"></div>

    <div id="screen-start" class="screen active">
        <div class="photo-frame">
            <div class="photo-inner">
                <img src="https://img.sanishtech.com/u/8e3173d0a35591f6fc15d024b7c6062b.png" alt="Start">
            </div>
        </div>
        <h1 style="color:var(--accent); margin-bottom:5px;">HEXA SORT</h1>
        <p style="color:#888; font-size:0.9rem; margin-bottom:20px;">Welcome yaaa.. semogaa kamu suka gamenyaa.</p>
        <button class="btn" onclick="startGame()">PLAY</button>
    </div>

    <div id="screen-game" class="screen">
        <div class="hud">
            <div style="font-size:0.8rem; letter-spacing:2px; margin-bottom:5px;">LEVEL PROGRESS</div>
            <div class="score-bar"><div class="score-fill" id="progress-bar"></div></div>
            <div id="status-text" style="font-size:0.7rem; color:#aaa;">0 / 8 SETS CLEARED</div>
        </div>
        
        <div id="hex-grid"></div>

        <div style="position:absolute; bottom:20px; width:100%; text-align:center;">
             <span style="font-size:0.7rem; color:#555; display:block; margin-bottom:10px;">Tap Stack -> Tap Tujuan</span>
             <button class="btn-shuffle" onclick="shuffleGame()">âš¡ SHUFFLE</button>
        </div>
    </div>

    <div id="screen-win" class="screen">
        <h1 style="color:var(--gold)">PERFECT!</h1>
        <div class="photo-frame" style="background:var(--gold)">
            <div class="photo-inner">
                <img src="https://img.sanishtech.com/u/2d50d09c95a82d3b204482edce3c2bfa.png" alt="End">
            </div>
        </div>
        <div class="text-area" id="final-text"></div>
        <button class="btn" style="border-color:var(--gold); color:var(--gold);" onclick="location.reload()">MAIN LAGI</button>
    </div>

    <script>
        // --- PESAN CINTA (EDIT DI SINI) ---
        const message = `EMMM HAAIII SAYANGGGG...

wihh mainin game ak lagii niii wkwkwkwkw, yaaa tapi gamenya seadanyaa yaaaa, bukan yang bener bener properr gituu hehehe. tapi aku yakin kali ini kamu akan suka fotonyaaa hehehee.. yaakk selamat bermain game ini yaakkk, kapanpun ituu kamuu.. semogaa aku ga maksain kamu buat mainin game inii yaa nadineee.. hehehee

emm kitaa mulai untuk longteks hari inii yaa sayanggg, cieeee yang udaa punyaa ktp wkwkwkwkwk.. anywayy timakasii yaa buat harii iniii, udaa nemenin aku sehariaannn.. dari pagii sudaa nemenin buat main minecraftt laluu ke lab jugaa nemenin buat kelompokannn, laluu jajann bersamaa kee koperasiii dann setelah ituuu nganterimn bisa nganterin kamu ke bk dann nganterin pulangg dehh, walaupunnn cumaa sampe parkirann ajaaa siii hehehe, tapii tetepp seruu koooo.. teruss cieeee udaa dapet ktp nih yaaaa.. yaa walaupun mungkin fotonya tida sesuai ekspektasimuu, tapii itss okeyylaaa yang penting datanyaa.. kamu biaaa premiumin danaa kamuu, teruss bisaa VOICE ROBLOKK JUGAKK.. alhamdulillah lah yaaa akhirnyaa bisa jugaa stelah hampir 18 tahunnn wkwkkww.. terusss tadii timakasii jugaa yaa udaa nemenin main minecraftt.. huhuu mintaa maaff banyak banyakk yaa malah buat kamu kesell di sisa hari iniii.. aku sedii bcss selalu jadi bebanmu di game manapunn.. even di minecraftt.. bisa bisanya sampe kamu kesel gituu tadi malemm jadinya aku sedii deee.. litterlyy satu map kamu yang gendong semuaa dan aku malah mengacaukan semuanyaaa.. sumpaah sedii bangett deehhh.. mintaa maaf yaa nadinee sekali lagiii dhajjsuxshjsjsis..

yasudaa deee segini dulu ajaa yaa longteks buat hari inii, mungkinn selamatt beristirahatt yaa nadineee, goodnight goodnightttt kalau kamu mainin game ini pagi pagiii.. selamaatt beraktivitasss yaaa sayanggg, semogaa besokk harinyaa lancarr yaaa, di sekolah jugaa kita bisa seneng bareng barengg yaaaa.. dann semogaa masih bisa main minecraft bareng bareng lagiii... aamiin, teruss kalau kamu bacaaa dan mainin game ini waktu pulang sekolah atau soree.. timakasii yaa buat harii iniii, walaupun aku gatauu gimana hari iniii.. aku tetep akan berterimakasii samaa kamuu dee yang selama ini sudaa selalu ada di sisikuuu.. jadii thanks for todayy yaaaa.. teruss kalau belum bisa berkesempatan mainin gamenya hari inii, itss okaayyy.. see uu nextimee yaaa kalau misal one day kamu bacaa longteks yang harii iniii.. okaayydeee timakasii sebanyak banyakknyaa yaa sayanggg.. maaff kalau kurang sempurnaa dari segalanyaa yaaa.. see uu sayanggg.. 

jee t'aimeeee bieennnn sayangkuu cintakuu, fathan sayang nadinee bangettðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ©µðŸ’™ðŸ’™ðŸ©µ`;

        // --- GAME SETTINGS ---
        const colors = ['c1', 'c2', 'c3', 'c4', 'c5']; // Merah, Biru, Ungu, Hijau, Kuning
        const POP_LIMIT = 5; // Harus 5 kartu baru pecah
        const TARGET_SETS = 6; // Total harus meledakkan 8 set (40 kartu total)
        
        // Grid Layout (Zigzag)
        const layout = [4, 4, 4, 4]; 
        
        let grid = [];
        let selectedIdx = null;
        let setsCleared = 0;
        let audioCtx;

        function initAudio() { if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
        function beep(type) {
            if(!audioCtx) return;
            const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            const now = audioCtx.currentTime;
            if(type==='sel'){ o.frequency.setValueAtTime(300, now); o.frequency.linearRampToValueAtTime(500, now+0.1); }
            if(type==='move'){ o.frequency.setValueAtTime(600, now); o.type='triangle'; }
            if(type==='pop'){ o.frequency.setValueAtTime(800, now); o.frequency.exponentialRampToValueAtTime(100, now+0.3); }
            g.gain.setValueAtTime(0.1, now); g.gain.linearRampToValueAtTime(0, now+0.2);
            o.start(now); o.stop(now+0.25);
        }

        function startGame() {
            initAudio();
            document.getElementById('screen-start').classList.remove('active');
            document.getElementById('screen-game').classList.add('active');
            generatePerfectLevel();
        }

        // --- ALGORITMA "PERFECT MATH" (ANTI SISA) ---
        function generatePerfectLevel() {
            grid = [];
            
            // 1. Buat "Kolam Kartu" yang pasti genap kelipatan 5
            // Total kartu = TARGET_SETS * POP_LIMIT
            let cardPool = [];
            for(let i=0; i<TARGET_SETS; i++) {
                // Pilih warna acak untuk setiap set
                let c = colors[Math.floor(Math.random() * colors.length)];
                // Masukkan 5 biji warna tersebut
                for(let k=0; k<POP_LIMIT; k++) cardPool.push(c);
            }
            
            // 2. Acak urutan kartu
            cardPool.sort(() => Math.random() - 0.5);

            // 3. Siapkan Grid Kosong
            let cellCount = 0;
            layout.forEach(cols => cellCount += cols);
            for(let i=0; i<cellCount; i++) grid.push([]);

            // 4. Distribusi kartu ke Grid (Max tumpukan awal 4 biar gak penuh tebing)
            cardPool.forEach(card => {
                // Cari cell random yang isinya masih < 4
                let attempts = 0;
                while(attempts < 100) {
                    let r = Math.floor(Math.random() * grid.length);
                    if (grid[r].length < 4) {
                        grid[r].push(card);
                        break;
                    }
                    attempts++;
                }
            });

            renderGrid();
        }

        function renderGrid() {
            const container = document.getElementById('hex-grid');
            container.innerHTML = '';
            
            let gridIdx = 0;
            layout.forEach(cols => {
                let row = document.createElement('div');
                row.className = 'hex-row';
                for(let c=0; c<cols; c++) {
                    let idx = gridIdx; // capture scope
                    let cellDiv = document.createElement('div');
                    cellDiv.className = 'hex-cell';
                    if (selectedIdx === idx) cellDiv.classList.add('selected');
                    
                    // Render kartu dalam cell
                    let stack = grid[idx];
                    stack.forEach(color => {
                        let t = document.createElement('div');
                        t.className = `tile t-${color}`;
                        cellDiv.appendChild(t);
                    });

                    cellDiv.onclick = () => handleTap(idx);
                    row.appendChild(cellDiv);
                    gridIdx++;
                }
                container.appendChild(row);
            });

            // Update HUD
            let pct = (setsCleared / TARGET_SETS) * 100;
            document.getElementById('progress-bar').style.width = pct + "%";
            document.getElementById('status-text').innerText = `${setsCleared} / ${TARGET_SETS} SETS CLEARED`;
        }

        function handleTap(idx) {
            beep('sel');
            
            // 1. Pilih Sumber
            if (selectedIdx === null) {
                if (grid[idx].length > 0) {
                    selectedIdx = idx;
                    renderGrid();
                }
                return;
            }

            // 2. Batal Pilih (Klik diri sendiri)
            if (selectedIdx === idx) {
                selectedIdx = null;
                renderGrid();
                return;
            }

            // 3. Logika Pindah
            let source = grid[selectedIdx];
            let target = grid[idx];
            let topColor = source[source.length - 1];

            // Syarat: Target kosong ATAU warna atasnya sama
            if (target.length === 0 || target[target.length - 1] === topColor) {
                
                // Pindahkan SEMUA warna yang sama berurutan
                while(source.length > 0 && source[source.length - 1] === topColor) {
                    // Batasi tinggi tumpukan target (opsional, misal max 10 biar ga offscreen)
                    if(target.length >= 10) break; 
                    target.push(source.pop());
                }
                
                beep('move');
                selectedIdx = null;
                
                // Cek apakah meledak?
                checkPop(target);
                
            } else {
                // Pindah gak valid, ganti seleksi kalau target ada isi
                if (target.length > 0) selectedIdx = idx;
                else selectedIdx = null;
            }
            
            renderGrid();
        }

        function checkPop(stack) {
            if (stack.length < POP_LIMIT) return;

            let topColor = stack[stack.length - 1];
            let count = 0;
            
            // Hitung dari atas ke bawah
            for (let i = stack.length - 1; i >= 0; i--) {
                if (stack[i] === topColor) count++;
                else break;
            }

            // Kalau pas 5 atau lebih
            if (count >= POP_LIMIT) {
                setTimeout(() => {
                    beep('pop');
                    // Hapus sejumlah count
                    for(let k=0; k<count; k++) stack.pop();
                    
                    // Hitung poin (kelipatan 5)
                    // Disini kita hitung per set. 1 Set = 5 kartu.
                    // Kalau user numpuk 10 sekaligus, itu 2 set.
                    let sets = Math.floor(count / POP_LIMIT); 
                    // Sebenarnya logicnya agak kompleks kalau sisa, tapi
                    // karena kita generate kelipatan 5, biasanya bersih.
                    // Kita anggap 1 ledakan = progress.
                    setsCleared++; 
                    
                    if (setsCleared >= TARGET_SETS) winGame();
                    
                    renderGrid();
                }, 300);
            }
        }

        function winGame() {
            setTimeout(() => {
                document.getElementById('screen-game').classList.remove('active');
                document.getElementById('screen-win').classList.add('active');
                typeText();
            }, 800);
        }

        // Fitur Shuffle (Kalau Nadine pusing/stuck)
        window.shuffleGame = function() {
            // Ambil semua kartu di papan
            let allCards = [];
            grid.forEach(stack => {
                while(stack.length) allCards.push(stack.pop());
            });
            
            // Acak
            allCards.sort(() => Math.random() - 0.5);
            
            // Sebar ulang
            allCards.forEach(card => {
                // Cari tempat random
                let r = Math.floor(Math.random() * grid.length);
                grid[r].push(card);
            });
            
            selectedIdx = null;
            renderGrid();
        }

        function typeText() {
            const el = document.getElementById('final-text');
            el.innerHTML = '';
            let i = 0;
            function t() {
                if(i<message.length){
                    el.innerHTML += message.charAt(i)==='\n'?'<br>':message.charAt(i);
                    i++; setTimeout(t, 50);
                }
            }
            t();
        }
    </script>
</body>
</html>
